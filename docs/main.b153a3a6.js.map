{"version":3,"sources":["webpack://nycticorax/webpack/runtime/chunk loaded","webpack://nycticorax/./src/core.ts","webpack://nycticorax/./src/connect.tsx","webpack://nycticorax/./demo/store/react.ts","webpack://nycticorax/./src/index.ts","webpack://nycticorax/./src/hooks.ts","webpack://nycticorax/./demo/index.less?fdaf","webpack://nycticorax/./demo/react.tsx","webpack://nycticorax/./demo/store/index.ts","webpack://nycticorax/./demo/run.tsx","webpack://nycticorax/./demo/index.tsx","webpack://nycticorax/./demo/index.less","webpack://nycticorax/webpack/bootstrap","webpack://nycticorax/webpack/runtime/compat get default export","webpack://nycticorax/webpack/runtime/define property getters","webpack://nycticorax/webpack/runtime/hasOwnProperty shorthand","webpack://nycticorax/webpack/runtime/jsonp chunk loading","webpack://nycticorax/webpack/startup"],"names":["deferred","constructor","state","this","keys","Reflect","ownKeys","next","forEach","key","value","undefined","JSON","parse","stringify","listener","listeners","push","slice","index","indexOf","splice","sync","emits","trigger","clearTimeout","timer","setTimeout","params","getStore","emit","o","actives","i","length","eq","ignoreStaticMethods","symbolKey","Symbol","nycticorax","Nycticorax","subscribe","dispatch","C","R","Component","props","componentDidMount","unsubscribe","triggerKeys","filter","k","includes","setState","componentWillUnmount","render","rest","Object","assign","getOwnPropertyNames","method","getConnect","setProps","useState","useLayoutEffect","getHook","createStore","connect","useStore","Hook","name","age","className","classes","type","onClick","console","log","s","setName","dp","gs","Promise","r","text","setAge","C0","loading","em","Math","random","toString","substring","desc","cs","F","useEffect","config","on","time","test","a","dispatcher1","dispatcher2","then","document","querySelector","___CSS_LOADER_EXPORT___","module","id","locals","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","__webpack_modules__","m","O","result","chunkIds","fn","priority","notFulfilled","Infinity","fulfilled","j","every","n","getter","__esModule","d","definition","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","installedChunks","179","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","data","moreModules","runtime","chunkLoadingGlobal","self","bind","__webpack_exports__"],"mappings":"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","file":"main.b153a3a6.js","sourcesContent":["var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tresult = fn();\n\t\t}\n\t}\n\treturn result;\n};","import eq from 'fast-deep-equal'\n\ntype Listener<T> = (keys: Partial<keyof T>[]) => void\n\nexport type Dispatch<T> = (\n  nycticorax: {\n    getStore: () => T,\n    emit: (next: Partial<T>) => void,\n  },\n  params?: any,\n) => Promise<any>\n\nexport type Dispatcher<T> = (next: Dispatch<T>, params?: any) => Promise<any>\n\nexport type Emiter<T> = (next: Partial<T>, sync?: boolean) => void\n\nexport type NycticoraxType<T extends object> = Nycticorax<T>\n\nclass Nycticorax<T extends object> {\n  private state: T\n\n  private listeners: Listener<T>[]\n\n  private emits: T\n\n  private timer: ReturnType<typeof setTimeout> | number | undefined\n\n  constructor() {\n    this.state = {} as T\n    this.listeners = []\n    this.emits = {} as T\n    this.timer = undefined\n  }\n\n  public createStore= (state: T): void => {\n    this.state = state\n  }\n\n  public getStore = (): T => {\n    const keys = Reflect.ownKeys(this.state) as Partial<keyof T>[]\n    const next = {} as T\n\n    keys.forEach((key) => {\n      const value = this.state[key]\n      if (value !== undefined) {\n        next[key] = JSON.parse(JSON.stringify(value))\n      }\n    })\n\n    return next\n  }\n\n  public subscribe = (listener: Listener<T>) => {\n    this.listeners.push(listener)\n\n    return () => {\n      const listeners = this.listeners.slice()\n      const index = listeners.indexOf(listener)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n      this.listeners = listeners\n    }\n  }\n\n  public emit: Emiter<T> = (next, sync) => {\n    this.emits = { ...this.emits, ...next }\n    if (sync) {\n      this.trigger()\n    } else {\n      clearTimeout(this.timer as number)\n      this.timer = setTimeout(this.trigger)\n    }\n  }\n\n  public dispatch: Dispatcher<T> = (next, params) => next({\n    getStore: this.getStore,\n    emit: (o: Partial<T>) => this.emit(o, true),\n  }, params)\n\n  private trigger = () => {\n    const next = this.emits\n    const actives: Partial<keyof T>[] = []\n    const keys = Reflect.ownKeys(next) as Partial<keyof T>[]\n\n    for (let i = 0; i < keys.length; i += 1) {\n      const key = keys[i]\n      // if (!(key in this.state)) {\n      //   continue\n      // }\n\n      if (eq(this.state[key], next[key])) {\n        continue\n      }\n\n      this.state[key] = next[key]\n      actives.push(key)\n    }\n\n    if (actives.length) {\n      this.listeners.forEach((listener) => listener(actives))\n    }\n\n    this.emits = {} as T\n    this.timer = undefined\n  }\n}\n\nexport default Nycticorax\n","import React, { Component, ComponentType } from 'react'\nimport { NycticoraxType, Emiter, Dispatcher } from './core'\nimport { Subtract } from './types'\n\nconst ignoreStaticMethods = [\n  'name',\n  'prototype',\n  'length',\n  'propTypes',\n  'defaultProps',\n  'getDerivedStateFromProps',\n  'contextTypes',\n  'displayName',\n]\n\nexport type Connect<T> = { emit: Emiter<T>, dispatch: Dispatcher<T> } & T\n\nfunction connect<T extends object>(nycticorax: NycticoraxType<T>) {\n  const {\n    getStore,\n    subscribe,\n    dispatch,\n    emit,\n  } = nycticorax\n\n  type ConnectProps = Connect<T>\n\n  return function (...keys: [Partial<keyof T>, ...Partial<keyof T>[]]) {\n    return function<P extends ConnectProps> (\n      C: ComponentType<P> & Record<string, any>,\n    ): ComponentType<Subtract<P, ConnectProps>> & Record<string, any> {\n      class R extends Component<Subtract<P, ConnectProps>> {\n        private unsubscribe: () => void\n\n        state = {\n          props: getStore(),\n        }\n\n        componentDidMount() {\n          this.unsubscribe = subscribe((triggerKeys) => {\n            const sames = keys.filter((k) => triggerKeys.includes(k))\n            if (sames.length) {\n              this.setState({ props: getStore() })\n            }\n          })\n        }\n\n        componentWillUnmount() {\n          this.unsubscribe()\n        }\n\n        render() {\n          const { props } = this.state\n          // eslint-disable-next-line prefer-object-spread\n          const rest = Object.assign({ dispatch, emit }, props, this.props as P)\n\n          return (\n            <C {...rest} />\n          )\n        }\n      }\n\n      Object\n        .getOwnPropertyNames(C)\n        .forEach((method) => {\n          const key = method as keyof typeof R\n          if (!ignoreStaticMethods.includes(method)) {\n            R[key] = C[key]\n          }\n        })\n\n      return R\n    }\n  }\n}\n\nexport default connect\n","import Nycticorax, { Dispatch as DP, Connect as CT } from '../../src'\n\nexport const symbolKey = Symbol('key')\n\ntype Store = { name: string, age: number, [symbolKey]: string }\n\nconst nycticorax = new Nycticorax<Store>()\n\nexport const {\n  createStore,\n  getStore,\n  dispatch,\n  subscribe,\n  connect,\n  useStore,\n  emit,\n} = nycticorax\n\nexport type Dispatch = DP<Store>\nexport type Connect = CT<Store>\n","import Nycticorax, { Dispatch } from './core'\nimport getConnect, { Connect } from './connect'\nimport getHook from './hooks'\n\nclass N<T extends object> extends Nycticorax<T> {\n  connect = getConnect(this)\n\n  useStore = getHook(this)\n}\n\nexport default N\nexport type { Dispatch }\nexport type { Connect }\n","import { useState, useLayoutEffect } from 'react'\nimport { NycticoraxType } from './core'\n\nfunction hooks<T extends object>(nycticorax: NycticoraxType<T>) {\n  const { getStore, subscribe } = nycticorax\n\n  return function (...keys: [Partial<keyof T>, ...Partial<keyof T>[]]) {\n    const [props, setProps] = useState(getStore())\n\n    useLayoutEffect(() => {\n      const unsubscribe = subscribe((triggerKeys) => {\n        const sames = keys.filter((k) => triggerKeys.includes(k))\n        if (sames.length) {\n          setProps(getStore())\n        }\n      })\n\n      return unsubscribe\n    })\n\n    return props\n  }\n}\n\nexport default hooks\n","import api from \"!../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[0].use[1]!../node_modules/less-loader/dist/cjs.js??ruleSet[1].rules[0].use[2]!./index.less\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","/* eslint-disable no-console */\nimport React, { Component } from 'react'\nimport {\n  createStore,\n  getStore,\n  subscribe,\n  Dispatch,\n  Connect,\n  connect,\n  useStore,\n  emit,\n  symbolKey,\n} from './store/react'\nimport classes from './index.less'\n\ncreateStore({ age: 0, name: 'abc', [symbolKey]: 'a' })\n\nsubscribe((keys) => {\n  console.log('subscribe', keys)\n  const s = getStore()\n\n  console.log(s[symbolKey])\n\n  if (s[symbolKey] === 'b') {\n    s[symbolKey] = 'aaaa'\n  }\n})\n\nfunction Hook() {\n  const { name, age } = useStore('name', 'age')\n\n  return (\n    <div className={classes.com}>\n      <h2>Hooks</h2>\n      <p>\n        <span>name:</span>\n        {name}\n      </p>\n      <p>\n        <span>age:</span>\n        {age}\n      </p>\n      <button\n        type=\"button\"\n        onClick={() => {\n          emit({ age: age + 1, [symbolKey]: 'b' })\n        }}\n      >\n        Dispatch\n      </button>\n    </div>\n  )\n}\n\nconst setName: Dispatch = async ({ emit: dp, getStore: gs }, params) => {\n  await new Promise((r) => setTimeout(r, 2000))\n  dp({ name: params?.text as string })\n  return gs().name\n}\n\nconst setAge: Dispatch = async ({ emit: dp, getStore: gs }) => {\n  const { age } = gs()\n  dp({ age: age + 1 })\n}\n\ntype TC = Connect & { desc: string }\n\nclass C0 extends Component<TC> {\n  state = {\n    loading: false,\n  }\n\n  setName = async () => {\n    const { loading } = this.state\n    if (loading) {\n      return\n    }\n\n    this.setState({ loading: true })\n    const { emit: em, dispatch: dp } = this.props\n    em({ age: 1 })\n    await dp(setName, {\n      text: Math.random().toString(36).substring(7),\n    })\n    this.setState({ loading: false })\n    console.log(getStore())\n  }\n\n  render() {\n    const { age, name, desc } = this.props\n    const { loading } = this.state\n\n    const cs = loading ? classes.loading : ''\n\n    return (\n      <div className={classes.com}>\n        <h2>{desc}</h2>\n        <p>\n          <span>name:</span>\n          {name}\n        </p>\n        <p>\n          <span>age:</span>\n          {age}\n        </p>\n        <button\n          className={cs}\n          type=\"button\"\n          onClick={this.setName}\n        >\n          Async Dispatch\n        </button>\n      </div>\n    )\n  }\n}\n\nfunction F0(props: TC) {\n  const {\n    age, name, dispatch: dp, desc,\n  } = props\n  return (\n    <div className={classes.com}>\n      <h2>{desc}</h2>\n      <p>\n        <span>name:</span>\n        {name}\n      </p>\n      <p>\n        <span>age:</span>\n        {age}\n      </p>\n      <button\n        type=\"button\"\n        onClick={() => {\n          dp(setAge)\n        }}\n      >\n        Dispatch\n      </button>\n    </div>\n  )\n}\n\nconst C = connect('age', 'name')(C0)\nconst F = connect('age', 'name')(F0)\n\nexport default function () {\n  return (\n    <>\n      <Hook />\n      <C desc=\"Class Component\" />\n      <F desc=\"Function Component\" />\n    </>\n  )\n}\n","import Nycticorax, { Dispatch as DP } from '../../src/core'\n\ntype Store = {\n  config: {\n    type: string,\n    on: boolean,\n  },\n  time: number,\n  test?: string,\n}\n\nconst nycticorax = new Nycticorax<Store>()\n\nexport const {\n  createStore,\n  getStore,\n  dispatch,\n  subscribe,\n  emit,\n} = nycticorax\n\nexport type Dispatch = DP<Store>\n","/* eslint-disable no-console */\nimport { useEffect } from 'react'\nimport {\n  createStore,\n  getStore,\n  dispatch,\n  emit,\n  subscribe,\n  Dispatch,\n} from './store/index'\n\nexport default () => {\n  useEffect(() => {\n    createStore({\n      config: {\n        type: 'page',\n        on: false,\n      },\n      time: 11,\n      test: undefined,\n    })\n\n    const unsubscribe = subscribe((keys) => {\n      console.log('subscribe', keys)\n    })\n\n    console.log('store0', getStore())\n\n    emit({ time: 1 })\n    emit({ config: { on: true, type: 'component' } })\n\n    console.log('store1', getStore())\n    setTimeout(() => console.log('store2', getStore()))\n\n    emit({ time: 2, test: '1111' }, true)\n\n    console.log('store3', getStore())\n\n    const dispatcher0: Dispatch = async ({ getStore: gs, emit: dp }, params) => {\n      console.log('params0', params)\n      const { time } = gs()\n      dp({ time: time + 1 })\n    }\n\n    dispatch(dispatcher0, { a: 1 })\n\n    const dispatcher1: Dispatch = async ({ getStore: gs, emit: dp }, params) => {\n      console.log('params1', params)\n      await new Promise((r) => setTimeout(r, 1000))\n      const { config } = gs()\n      if (typeof params?.type === 'boolean') {\n        config.on = params.type\n      }\n      dp({ config })\n    }\n\n    const dispatcher2: Dispatch = async ({ getStore: gs }) => {\n      const { config } = gs()\n      console.log(config)\n      return 1\n    }\n\n    dispatch(dispatcher1, { type: false })\n\n    dispatch(dispatcher2).then(() => {\n      console.log('2')\n      emit({ time: 1000 })\n    })\n\n    unsubscribe()\n  }, [])\n\n  return null\n}\n","/* eslint-disable import/no-extraneous-dependencies */\nimport React from 'react'\nimport { render } from 'react-dom'\nimport Com from './react'\nimport Run from './run'\nimport classes from './index.less'\n\nrender((\n  <div className={classes.container}>\n    <div className={classes.co}>\n      <Com />\n    </div>\n    <div className={classes.ru}>\n      <Run />\n    </div>\n  </div>\n), document.querySelector('#root'))\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"@keyframes spin_2jXe4 {\\n  0% {\\n    transform: rotate(0deg);\\n  }\\n  100% {\\n    transform: rotate(360deg);\\n  }\\n}\\n.container_2cx6z {\\n  display: flex;\\n  flex-direction: column;\\n  height: 100vh;\\n}\\n.right_1T0vt {\\n  border-left: 1px solid #eee;\\n  padding: 20px;\\n  white-space: pre;\\n}\\n.right_1T0vt h2 {\\n  margin: 0 0 0 5px;\\n  font-size: 16px;\\n  color: #10f108;\\n  padding: 3px 7px;\\n  font-weight: normal;\\n  background: #242425;\\n  border-radius: 2px;\\n  display: inline-block;\\n}\\n.co_1hMsD {\\n  display: flex;\\n  padding: 20px;\\n}\\n.com_3UsWm {\\n  border: 1px solid #eee;\\n  padding: 20px;\\n  flex: 1;\\n  border-radius: 2px;\\n}\\n.com_3UsWm:nth-child(2) {\\n  margin: 0 20px;\\n}\\n.com_3UsWm h2 {\\n  font-size: 24px;\\n  margin: 0;\\n  font-weight: 400;\\n  color: #333;\\n  margin-bottom: 30px;\\n}\\n.com_3UsWm button {\\n  margin-top: 20px;\\n  font-size: 14px;\\n  color: #fff;\\n  background: #0170fe;\\n  padding: 4px 10px;\\n  border-radius: 3px;\\n  border: 1px solid #0170fe;\\n  cursor: pointer;\\n  position: relative;\\n}\\n.com_3UsWm button.loading_2tX-6 {\\n  padding-left: 24px;\\n}\\n.com_3UsWm button.loading_2tX-6::before {\\n  content: '';\\n  position: absolute;\\n  left: 4px;\\n  top: 4px;\\n  border: 2px solid #f3f3f3;\\n  border-top: 2px solid #3498db;\\n  border-radius: 50%;\\n  width: 12px;\\n  height: 12px;\\n  animation: spin_2jXe4 2s linear infinite;\\n}\\n.com_3UsWm p {\\n  font-size: 16px;\\n  color: #555;\\n  margin: 10px 0;\\n}\\n.com_3UsWm p span {\\n  color: #888;\\n  margin-right: 5px;\\n}\\nbody {\\n  margin: 0;\\n  font-family: Georgia, 'Times New Roman', Times, serif;\\n}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./demo/index.less\"],\"names\":[],\"mappings\":\"AAAA;EACE;IAAK,uBAAA;EAEL;EADA;IAAO,yBAAA;EAIP;AACF;AAFA;EACC,aAAA;EACA,sBAAA;EACA,aAAA;AAID;AADA;EACC,2BAAA;EACA,aAAA;EACA,gBAAA;AAGD;AANA;EAME,iBAAA;EACA,eAAA;EACA,cAAA;EACA,gBAAA;EACA,mBAAA;EACA,mBAAA;EACA,kBAAA;EACA,qBAAA;AAGF;AACA;EACC,aAAA;EACA,aAAA;AACD;AAEA;EACC,sBAAA;EACA,aAAA;EACA,OAAA;EACA,kBAAA;AAAD;AAEC;EACC,cAAA;AAAF;AAPA;EAWE,eAAA;EACA,SAAA;EACA,gBAAA;EACA,WAAA;EACA,mBAAA;AADF;AAdA;EAmBE,gBAAA;EACA,eAAA;EACA,WAAA;EACE,mBAAA;EACF,iBAAA;EACA,kBAAA;EACA,yBAAA;EACA,eAAA;EACA,kBAAA;AAFF;AAIE;EACC,kBAAA;AAFH;AAIG;EACC,WAAA;EACA,kBAAA;EACA,SAAA;EACA,QAAA;EACA,yBAAA;EACC,6BAAA;EACA,kBAAA;EACA,WAAA;EACA,YAAA;EACA,wCAAA;AAFL;AAxCA;EAgDE,eAAA;EACA,WAAA;EACA,cAAA;AALF;AA7CA;EAqDG,WAAA;EACA,iBAAA;AALH;AASA;EACC,SAAA;EACA,qDAAA;AAPD\",\"sourcesContent\":[\"@keyframes spin {\\n  0% { transform: rotate(0deg); }\\n  100% { transform: rotate(360deg); }\\n}\\n\\n.container {\\n\\tdisplay: flex;\\n\\tflex-direction: column;\\n\\theight: 100vh;\\n}\\n\\n.right {\\n\\tborder-left: 1px solid #eee;\\n\\tpadding: 20px;\\n\\twhite-space: pre;\\n\\n\\th2 {\\n\\t\\tmargin: 0 0 0 5px;\\n\\t\\tfont-size: 16px;\\n\\t\\tcolor: #10f108;\\n\\t\\tpadding: 3px 7px;\\n\\t\\tfont-weight: normal;\\n\\t\\tbackground: #242425;\\n\\t\\tborder-radius: 2px;\\n\\t\\tdisplay: inline-block;\\n\\t}\\n}\\n\\n.co {\\n\\tdisplay: flex;\\n\\tpadding: 20px;\\n}\\n\\n.com {\\n\\tborder: 1px solid #eee;\\n\\tpadding: 20px;\\n\\tflex: 1;\\n\\tborder-radius: 2px;\\n\\n\\t&:nth-child(2) {\\n\\t\\tmargin: 0 20px;\\n\\t}\\n\\n\\th2 {\\n\\t\\tfont-size: 24px;\\n\\t\\tmargin: 0;\\n\\t\\tfont-weight: 400;\\n\\t\\tcolor: #333;\\n\\t\\tmargin-bottom: 30px;\\n\\t}\\n\\n\\tbutton {\\n\\t\\tmargin-top: 20px;\\n\\t\\tfont-size: 14px;\\n\\t\\tcolor: #fff;\\n    background: #0170fe;\\n\\t\\tpadding: 4px 10px;\\n\\t\\tborder-radius: 3px;\\n\\t\\tborder: 1px solid #0170fe;\\n\\t\\tcursor: pointer;\\n\\t\\tposition: relative;\\n\\n\\t\\t&.loading {\\n\\t\\t\\tpadding-left: 24px;\\n\\n\\t\\t\\t&::before {\\n\\t\\t\\t\\tcontent: '';\\n\\t\\t\\t\\tposition: absolute;\\n\\t\\t\\t\\tleft: 4px;\\n\\t\\t\\t\\ttop: 4px;\\n\\t\\t\\t\\tborder: 2px solid #f3f3f3;\\n  \\t\\t\\tborder-top: 2px solid #3498db;\\n  \\t\\t\\tborder-radius: 50%;\\n  \\t\\t\\twidth: 12px;\\n  \\t\\t\\theight: 12px;\\n  \\t\\t\\tanimation: spin 2s linear infinite;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t}\\n\\n\\tp {\\n\\t\\tfont-size: 16px;\\n\\t\\tcolor: #555;\\n\\t\\tmargin: 10px 0;\\n\\n\\t\\tspan {\\n\\t\\t\\tcolor: #888;\\n\\t\\t\\tmargin-right: 5px;\\n\\t\\t}\\n\\t}\\n}\\nbody {\\n\\tmargin: 0;\\n\\tfont-family: Georgia, 'Times New Roman', Times, serif;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"container\": \"container_2cx6z\",\n\t\"right\": \"right_1T0vt\",\n\t\"co\": \"co_1hMsD\",\n\t\"com\": \"com_3UsWm\",\n\t\"loading\": \"loading_2tX-6\",\n\t\"spin\": \"spin_2jXe4\"\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t179: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tfor(moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) var result = runtime(__webpack_require__);\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkIds[i]] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunknycticorax\"] = self[\"webpackChunknycticorax\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [736], () => (__webpack_require__(269)))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"sourceRoot":""}